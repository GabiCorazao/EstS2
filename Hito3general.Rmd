---
title: "HITO 3 - GRUPO 2"
output: html_notebook
---
HITO 3 - GRUPO 2

PRODUCTO 1: 

#PASO 0: IMPORTAMOS LA DATA BASEFINAL DEL GITHUB
```{r}
library(rio)
basefinal=import('https://github.com/DanaeNorah/Estadistica-para-el-Analisis-Politico-2-/raw/master/TRABAJO/basefinal.csv')
data= basefinal
str(data)
```
1. ANALISIS UNIVARIADO DE NUESTAS VARIABLES

VARIABLE DEPENDIENTE: Indice de Desigualdad de Genero
```{r}
#Solicitamos estadisticos descriptivos
summary(base$DesigualdadGenero)
```

```{r}
library(psych)
describe.by(base$DesigualdadGenero)
```


```{r}
#Analisis grafico de variable
#Solicitamos histograma
hist(base$DesigualdadGenero)
```

VARIABLES INDEPENDIENTES

PASO 1: VARIABLE NUMERICA Autonomia reproductiva

```{r}
#Para recodificar tenemos que abrir la libreria car
library(car)
#Revisamos valores iniciales
table(data$Autonomia)
```

```{r}
#Para recodificar usamos la funcion recode
data$Autonomia1 <- recode(data$Autonomia, "0=0 ; 0.25=0 ; 0.5=0.5 ; 0.75=1 ; 1=1")
#Verificamos los nuevos valores
table(data$Autonomia1)
```

```{r}
#Luego, variable debe ser convertida en una variable tipo factor
data$Autonomia1 <- as.factor(data$Autonomia1)
#Le asignamos etiquetas a los valores
levels(data$Autonomia1)<-c("Bueno","Regular","Malo")
#verificamos
str(data$Autonomia1)
table(data$Autonomia1)
```

Analisis univariado
```{r}
#Solicitamos estadisticos descriptivos
summary(base$Autonomia)
describe.by(base$Autonomia)
```
- Graficos
```{r}
#Solicitamos un grafico de pie

```

PASO 2: VARIABLE NUMERICA  Violencia contra la mujer

```{r}
#Revisamos los valores
table(data$Violencia)
```

```{r}
#Empleamos funcion recode
data$Violencia1 <- recode(data$Violencia, "0=0 ; 0.25=0 ; 0.5=0.5 ; 0.75=1 ; 1=1")
#Verificamos
table(data$Violencia1)
```

```{r}
#Luego, variable debe ser convertida en una variable tipo factor
data$Violencia1 <- as.factor(data$Violencia1)
#Le asignamos etiquetas a los valores
levels(data$Violencia1)<-c("Bueno","Regular","Malo")
#verificamos
str(data$Violencia1)
table(data$Violencia1)
```

Analisis univariado

```{r}
#Solicitamos estadisticos descriptivos
summary(base$Violencia)
describe.by(base$Violencia)
```
- Graficos
```{r}
#Solicitamos un grafico de pie

```
PASO 3: VARIABLE NUMERICA VozPolitica

```{r}
#Solicitamos las medidas de tendencia central
library(psych)
library(DescTools)
describeBy(data$VozPolitica)
summary(data$VozPolitica)
```


- Graficos
```{r}
#Solicitamos un histograma
hist(data$VozPolitica, col = "green", main="Voz politica", xlab = "Por parlamento", ylab ="Porcnetaje de mujeres")
#Solicitamos un boxplot para ver los outliers
boxplot(data$VozPolitica, col = "lightgreen", main="Voz politica")
```


PASO 4: VARIABLE NUMERICA LibertadMov (libertad de movimiento)
```{r}
#Solicitamos las medidas de tendencia central
describeBy(data$LibertadMov)
summary(data$LibertadMov)
```

- Graficos
```{r}
#Solicitamos un histograma 
hist(data$LibertadMov, col = "lightblue", main="Libertad de movimiento", xlab = "", ylab =NULL)
#Solicitamos un boxplot para ver los outliers
boxplot(data$LibertadMov, col = "red", main="Libertad de movimiento")
```

PASO 5: Analisis descriptivo de la variable "AccesoJ"
```{r}
#Solicitamos el desvrybeBy para el analisis univariado
describeBy(data$AccesoJ, digits=2)
```

- Graficos
```{r}
#Solicitamos un boxplot
boxplot(data$AccesoJ, col = "lightgreen", main="Acceso a Justicia")
#Solicitamos un histograma
hist((data$AccesoJ),col="lightblue",
        xlab="Cantidad de paises",
        ylab="Acceso a justicia",
        main="Acceso a Justicia")
```


PASO 6: Analisis descriptivo de la variable "SecundariaC"
```{r}
#Solicitamos el desvrybeBy para el analisis univariado
describeBy(data$SecundariaC, digits=2)
```

- Graficos
```{r}
#Solicitamos un boxplot
boxplot(data$SecundariaC, col = "lightgreen", main="Secundaria Completa")
#Solicitamos el histograma
hist((data$SecundariaC),col="lightblue",
        xlab="Cantidad de paises",
        ylab="Promedio de mujeres con secundaria completa",
        main="Mujeres con secundaria completa")
```

PASO 7: Analisis descriptivo de la variable "Desempleo"
```{r}
#Solicitamos el desvrybeBy para el analisis univariado
describeBy(data$Desempleo, digits=2)
```

- Graficos
```{r}
#Solicitamos un boxplot
boxplot(data$Desempleo,  col="blue", main="Boxplot de Desempleo")
#Solicitamos el histograma
hist((data$Desempleo), col="blue",
        xlab="Cantidad de paises",
        ylab="Proporcion de mujeres desempleadas",
        main="Mujeres desempleadas")
```

PASO8: Analisis descriptivo de la variable "CuentaF"
```{r}
#Solicitamos el desvrybeBy para el analisis univariado
describeBy(data$CuentaF, digits=2)
```

```{r}
#Solicitamos un boxplot
boxplot(data$CuentaF, main="Boxplot de Cuenta Financiera ", col="blue")
#Solicitamos el histograma
hist((data$CuentaF), col="blue",
        xlab="Cantidad de paises",
        ylab="Porcentaje de mujeres con banca movil",
        main="Mujeres con banca movil")
```

PASO 9: aplicamos las funciones para todas las vairables a la vez
```{r}
#para varias variables
describeBy(as.matrix(cbind(data[,c(2:10)])), digits = 2)
#summary
summary(data[,c(2:10)])
```


2. ANALISIS BIVARIADO: CORRELACION Y GRÁFICO DE DISPERSION



#PASO 1: ANOVA de un factor entre  "DesigualdadGenero"y "Autonomía"

```{r}
#Aplicamos la prueba ANOVA de un factor. Usamos la nueva variable creada unos pasos atrás.
anovaautonomia <- aov(data$DesigualdadGenero ~ data$Autonomia1)
summary(anovaautonomia)
```
                  Pr(>F)    
data$Autonomia1   4.26e-09 ***

```{r}
#Prueba de comparaciones múltiples (Tukey)
TukeyHSD(anovaautonomia)
```

                p adj
Regular-Bueno 0.0001108
Malo-Bueno    0.0000000
Malo-Regular  0.9530128

```{r}
#Gráfico de medias con intervalos de confianza (ver superposición)
install.packages("gplots")
library(gplots) 
plotmeans(data$DesigualdadGenero ~ Autonomia1, data = data)
```

#PASO 2: ANOVA de unfactor entre  "DesigualdadGenero"y "Violencia"
```{r}
#Aplicamos la prueba ANOVA de un factor
anovaviolencia <- aov(data$DesigualdadGenero ~ data$Violencia1)
summary(anovaviolencia)
```
                  Pr(>F)   
data$Violencia1   0.00644 **

```{r}
#Prueba de comparaciones múltiples (Tukey)
TukeyHSD(anovaviolencia)
```
                p adj
Regular-Bueno   0.0112447
Malo-Bueno      0.0113994
Malo-Regular    0.8572113

```{r}
#Gráfico de medias con intervalos de confianza (ver superposición)
plotmeans(data$DesigualdadGenero ~ Violencia1, data = data)
```


#PASO 3: Correlacion entre  "DesigualdadGenero"y "VozPolitica"
```{r}
#Analisis visual usando un grafico de dispersion
plot(data$DesigualdadGenero, data$VozPolitica, xlab="Desigualdad de Genero", ylab="Voz Politica")
#Solicitamos la prueba R de Pearson
cor.test(data$DesigualdadGenero, data$VozPolitica)
## H0: Las variables son estadIsticamente independientes
## HA: Las variables son estadIsticamente dependientes
```

RESPUESTA: cor = -0.3797722  p-value = 6.529e-06

Que tan fuerte es la correlacion? Que sentido tiene? Por que?

#PASO 4: Correlacion entre  "DesigualdadGenero"y "LibertadMov"(libertad de movimiento)
```{r}
#Analisis visual usando un grafico de dispersion
plot(data$DesigualdadGenero, data$LibertadMov, xlab="Desigualdad de Genero", ylab="Libertad de movimiento")
#Solicitamos la prueba R de Pearson
cor.test(data$DesigualdadGenero, data$LibertadMov)
## H0: Las variables son estadIsticamente independientes
## HA: Las variables son estadIsticamente dependientes
```
RESPUESTA: cor = -0.4299311  p-value = 2.41e-07

#PASO 5: Correlacion entre  "DesigualdadGenero"y "AccesoJ"(acceso a justicia)
```{r}
#Analisis visual usando un grafico de dispersion
plot(data$DesigualdadGenero, data$AccesoJ, xlab="Desigualdad de Genero", ylab="Acceso a Justicia")
#Solicitamos la prueba R de Pearson
cor.test(data$DesigualdadGenero, data$AccesoJ)
## H0: Las variables son estadIsticamente independientes
## HA: Las variables son estadIsticamente dependientes
```
RESPUESTA: cor = -0.1588468   p-value = 0.06888

#PASO 6: Correlacion entre  "DesigualdadGenero"y "SecundariaC"(secundaria completa)
```{r}
#Analisis visual usando un grafico de dispersion
plot(data$DesigualdadGenero, data$SecundariaC, xlab="Desigualdad de Genero", ylab="Secundaria Completa")
#Solicitamos la prueba R de Pearson
cor.test(data$DesigualdadGenero, data$SecundariaC) 
## H0: Las variables son estadIsticamente independientes
## HA: Las variables son estadIsticamente dependientes
```
RESPUESTA: cor = -0.7925136   p-value < 2.2e-16

#PASO 7: Correlacion entre  "DesigualdadGenero"y "Desempleo"
```{r}
#Analisis visual usando un grafico de dispersion
plot(data$DesigualdadGenero, data$Desempleo, xlab="Desigualdad de Genero", ylab="Desempleo")
#Solicitamos la prueba R de Pearson
cor.test(data$DesigualdadGenero, data$Desempleo)
## H0: Las variables son estadIsticamente independientes
## HA: Las variables son estadIsticamente dependientes
```
RESPUESTA: cor = 0.01774458  p-value = 0.8227

#PASO 8: Correlacion entre  "DesigualdadGenero"y "CuentaF"(Cuenta financiera)
```{r}
#Analisis visual usando un grafico de dispersion
plot(data$DesigualdadGenero, data$CuentaF, xlab="Desigualdad de Genero", ylab="Cuenta financiera")
#Solicitamos la prueba R de Pearson
cor.test(data$DesigualdadGenero, data$CuentaF) 
## H0: Las variables son estadIsticamente independientes
## HA: Las variables son estadIsticamente dependientes
```
RESPUESTA: cor = -0.8300363  p-value < 2.2e-16